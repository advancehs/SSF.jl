using SSF, Test,LinearAlgebra


function get_rowIDT(tvar) 

    # Create a matrix of panel information.

    T  = length(unique(tvar)) # T=number of panels
    id = Array{Any}(undef,T,2)
    id[:,1] = unique(tvar)    # list of year with no repetition
    @inbounds for i = 1:T
        @views id[i,2]= sum(tvar.== id[i,1])    # number of periods for the panel
    end
    @views Nᵢ = id[:,2]

    rowID =  Vector{Vector}()  
    @inbounds for i=1:T
        @views cc = findall(x-> x == id[i,1], tvar) # row index of i'th year
        push!(rowID, cc) # put the year info in the vector; faster than using UnitRange
    end    
  
    rowIDT = hcat(rowID, Nᵢ) 

    return rowIDT # (Nx2): col_1 is panel's row info; col_2 is panel's number of periods
end



@testset verbose=true "Part 2 (panel) of log-likelihood functions, marginal effect, jlms & bc index" begin


    
    
	data= [
        1.024936413	1.341614048	-0.088181101	0.528031349	1
        0.467095691	0.344641786	-0.46819183	-0.194299847	1
        0.816514918	0.572677489	-0.42019829	-1.910461545	1
        2.22877975	2.954620879	0.49501547	0.15579699	1
        -0.40261065	-0.555557807	-0.88912624	0.985456645	1
        0.674216161	-0.849174101	0.051709499	0.716300011	1
        -0.205341814	0.243986877	-0.39771321	0.303866595	1
        0.18020383	1.42360467	-1.2200511	-0.697692871	1
        1.834861915	1.23794544	0.91598451	-0.373987138	1
        -0.997581784	0.58405255	-1.7923896	-1.1906147	1
        -0.445396944	0.868289175	-1.036859	1.304698229	1
        2.231146115	2.362485232	0.43564096	-0.495114952	1
        -0.308891571	0.115219837	-0.3690702	1.742094278	1
        -0.309039621	1.1351457	-1.7728058	0.650990963	1
        -0.913478333	-0.894396329	-1.346362	-0.238334507	1
        2.236090516	-0.286095763	2.4097197	1.312317848	1
        0.629569893	0.267112738	0.16379088	-0.265733302	1
        1.328198408	-0.027504707	1.3490415	-0.666596472	1
        1.128483331	1.871226083	-0.015142038	-0.002105683	1
        -0.038383281	0.683683227	0.16206567	0.517871976	1
        0.727813123	0.302640359	0.50873786	1.601477623	1
        1.642111097	2.050699364	0.62361604	0.27394408	1
        -0.157459142	-0.564202775	0.60581595	0.893241763	1
        1.482451987	2.24884225	0.12970796	0.166693658	1
        -0.863500757	1.152301693	-2.1836081	-1.020496249	1
        0.87169825	0.735716322	0.99254602	0.552345932	1
        1.109081016	-0.051021314	2.2554977	0.348177165	1
        0.272191007	0.711594486	0.30744079	0.365812838	1
        -3.762219437	1.305808985	-1.2674989	3.474610329	1
        -0.385322807	0.61095515	-1.3729197	-0.456556737	1
        1.160593023	1.751732426	0.13981852	-2.146660328	1
        0.42908912	1.177489715	-1.1459388	-0.050991945	1
        1.494233886	0.91885485	1.3296528	1.051414013	1
        0.48458249	1.618854122	-0.62657934	1.173964739	1
        -0.455754588	-0.798531336	-0.49103913	0.640784979	1
        -0.548990187	-0.700724048	-1.1209958	-0.247391939	1
        0.74006998	0.39107633	0.68252128	2.267077684	1
        1.46351775	2.884784494	-0.55154115	-0.770951807	1
        0.440057059	1.657053087	-0.49630001	-0.852630436	1
        2.500430277	3.662581239	-0.59680867	-1.828111529	1
        -0.076072639	-0.354534592	-1.2649693	-0.392205685	1
        1.445265683	-0.31067213	0.72483277	-0.008370521	1
        -0.211348346	-0.632143112	0.31287023	-0.736091375	1
        0.63146224	1.107556848	0.43176785	0.472869873	1
        0.291855577	0.175073783	0.33665133	1.17298758	1
        -0.865986423	0.458821831	-1.331893	-1.308203936	1
        0.121659468	-0.32295713	0.65884751	0.451748371	1
        -0.983744889	-1.443714054	0.66360027	0.047293615	1
        -0.911211193	-0.492151284	-0.81592649	1.125710011	1
        1.034349847	1.336601115	0.030828441	-0.872531295	1
        -0.377445317	0.091360609	0.36924356	-0.372437477	1
        -0.076269261	0.849077082	0.58020455	1.117667317	1
        0.667237856	1.208114124	0.1137559	-0.767433763	1
        -0.424770243	2.269811965	-1.6396576	-0.180592775	1
        -0.311120039	0.914062642	-0.45533642	0.00778214	1
        0.461494002	0.82893517	-0.02388175	-0.893471062	1
        1.06206248	0.091624142	0.76039475	-0.419655353	1
        1.011155623	0.240480551	1.6034857	-0.840487063	1
        0.427933279	0.311201074	0.90295357	0.976349115	1
        -1.979626872	1.334055328	-2.5475664	2.199929237	1
        1.776423274	1.648692821	0.97234839	0.315023214	1
        0.336651625	-0.45768174	-0.14927024	-0.827780008	1
        -0.042555609	-0.832304085	-0.3467212	-0.653299391	1
        2.842075627	0.795652663	1.9189184	0.00769014	1
        0.188807043	0.001649534	-0.67608285	-0.238109723	1
        1.204992299	1.469416832	0.004462726	-0.059264082	1
        -0.896324782	-0.538073298	-0.53135777	-0.044206675	1
        2.783304031	2.995660547	1.7072634	-0.87621361	1
        0.842845515	1.209140066	-0.42821658	-1.189553142	1
        -1.063838107	-1.524156805	-0.3683008	0.078107931	1
        1.126865737	1.346485619	-0.40580818	-1.47098732	1
        1.164106464	1.178250317	1.4507065	-0.168402821	1
        -0.064190905	0.071027496	-1.6329284	-1.620897889	1
        0.80646244	1.879417994	-0.84075278	0.922018588	1
        0.144535664	-0.252414367	-0.37154067	0.251590461	1
        0.756917863	0.180824795	0.46421728	0.761926353	1
        3.275831908	2.174248674	1.6276337	-0.092029326	1
        -0.207908186	0.558418878	-1.5243713	-1.165574193	1
        -0.834783356	-0.489450742	-0.13701436	-0.329652458	1
        1.175847885	1.463265728	0.74772608	-0.352814913	1
        0.52719191	0.957882653	0.13742949	-0.378222525	1
        0.20600271	0.754694413	0.49733141	0.530831099	1
        -0.02360058	-0.072029878	0.43386301	-0.045419771	1
        1.343252754	2.38635094	-0.31126007	-1.721483946	1
        0.518650451	1.252361289	-0.75865	-2.800806522	1
        2.724343568	0.933284614	1.5574851	0.394320339	1
        0.911906489	-0.029733904	1.1519209	-0.878911257	1
        -0.209656222	0.113787285	-1.4762974	0.15830642	1
        1.474791444	3.637225262	-1.5245341	0.876195729	1
        0.091049431	0.332954995	-0.98251158	-0.335015833	1
        0.210159724	0.416086923	0.24970585	0.239743724	1
        0.566698848	0.516067456	-0.067106754	-0.559430301	1
        -0.622112458	-0.095596035	-1.351545	-0.99847728	1
        0.502422608	0.610506277	-0.52506787	0.434463978	1
        -1.064058436	0.36292475	-0.88086241	1.061669946	1
        -0.995241285	-0.406663974	-0.4489612	1.179407835	1
        -0.022870576	-2.282428039	0.87279862	0.498991311	1
        3.585319761	3.791164385	1.6415462	-0.610933185	1
        0.02415526	1.272503184	-0.91376019	-0.347745329	1
        -0.045154777	1.147273885	-1.435902	-1.099843979	1
        0.720108178	1.239531742	-0.29645643	-1.318690896	1
        0.203939555	-0.267019225	0.65710455	1.518511891	1
        1.439911112	1.754626137	-0.69646001	0.395085096	1
        2.133396291	0.864695606	0.066063173	-1.826855898	1
        0.736748987	-0.478360492	0.74321198	0.126607433	1
        2.190209174	2.06627087	0.41575903	-0.629732668	1
        -0.303291656	-0.893972117	-1.3160133	0.260231644	1
        1.826948759	0.565584612	0.49139938	-1.241933942	1
        1.237095684	2.360153573	0.5916779	0.066222876	1
        0.483295714	2.456121104	-1.4873185	1.546675682	1
        -0.681191486	-1.21204303	0.36376572	1.817357183	1
        0.883638498	0.207640709	0.84669268	0.661681831	1
        2.077928212	1.657846706	1.5329055	-0.535484195	1
        -0.279489032	1.069773631	-1.292037	-0.262089849	1
        0.701594807	-0.163492294	1.4993485	2.38166976	1
        0.388025552	0.595130177	-0.12648708	1.142133951	1
        -0.050145201	0.212495564	-1.1887009	-0.531722605	1
        0.326478211	1.891225008	-1.2678987	-0.357131302	1
        1.320592886	1.811614899	0.40064332	1.10666883	1
        0.101972902	0.958328394	-1.3725715	0.537872314	1
        0.017300119	0.110926028	-0.17482711	-0.045449849	1
        0.02582077	1.26059414	-0.7746889	0.646182775	1
        0.130487725	-1.109567274	0.69379199	-0.086991973	1
        1.776954354	-0.770463456	2.997674	0.574496508	1
        1.196654993	-1.157422889	1.1836809	-0.54137224	1
        0.664005662	0.07428744	0.53564715	-1.566429973	1
        1.116695136	1.920844747	0.56077778	-0.219818786	1
        1.606746715	1.107962264	1.2391646	1.076409459	1
        1.298768452	1.377597763	0.3991693	-2.040325642	1
        1.60002419	1.532225265	0.89152241	0.082447357	1
        -0.730441685	-0.244265543	-1.0340858	0.343114227	1
        0.38626529	1.01491095	-0.02359256	0.532930255	1
        -0.214220694	-0.34544914	-0.3341763	-2.448050261	1
        -0.551702669	-1.051229288	0.24118745	0.573957503	1
        0.706411207	1.937196801	-0.73800826	-0.111554459	1
        0.550183802	-0.086500992	0.45215249	-1.37357223	1
        0.186092172	1.207982491	-0.23553643	0.187030032	1
        1.024296098	1.185519526	-0.29867151	-0.033185024	1
        0.249818819	0.925835819	-0.52564353	0.584682345	1
        1.587472169	0.607777958	0.57183307	-0.521816611	1
        1.016243104	1.649113388	-0.50229198	-0.493799895	1
        0.931889995	1.375946791	-0.49193108	-0.917108715	1
        1.964150123	-0.054417758	2.0142069	-0.650124907	1
        0.501608677	-1.034250944	0.84849244	-0.793377817	1
        1.666979072	0.322381903	0.73875564	-2.024505377	1
        1.559709182	0.469956812	1.941223	0.922954142	1
        -0.07926952	-1.139438103	0.067439713	-1.445255637	1
        0.387157011	-0.05277444	-0.80183876	-0.49282065	1
        1.284504032	0.569282711	0.4136557	0.716199517	1
        0.865031854	0.031192411	1.1000105	0.902175307	1
        0.730565964	1.798986196	-0.48004735	1.035350561	1
        1.95124535	3.001209139	0.048407473	1.219103694	1
        1.831446559	1.55339539	0.69384772	1.57050705	1
        1.492525051	0.933029323	0.40609187	0.81227231	1
        -1.496146452	-0.60949719	-2.187248	0.940804958	1
        0.506094414	0.444931625	-1.4448863	-0.153406665	1
        0.166622695	0.836667223	-0.42952389	-1.359926105	1
        -0.093781543	0.728659732	-0.34429294	1.416284323	1
        2.065723434	0.570950998	2.3941526	-1.682051182	1
        0.857038452	1.090891702	-0.38470322	-0.142477363	1
        -0.040873068	0.226010112	-0.4154624	1.128208995	1
        0.155866549	0.47857259	-0.92373514	0.752048612	1
        1.811910134	0.568827002	0.76599818	-2.132312298	1
        1.4970391	0.25738269	1.7090279	1.169651628	1
        0.984690208	-0.739126982	0.68771309	0.505812943	1
        0.262000719	0.028388618	-0.31765527	0.488094836	1
        1.16934185	0.983939795	-0.38271418	0.650551558	1
        0.198339962	1.080524741	-0.051615462	1.211371064	1
        -1.335633457	-0.8110135	-1.2086973	1.586803436	1
        1.395359591	1.685549696	0.59563953	1.609909534	1
        0.581303188	-0.879092257	0.70420015	0.234665602	1
        -0.199881322	-0.741265933	0.073560342	-1.404735208	1
        -1.034132968	-0.942762058	-0.41774508	1.65662539	1
        0.031438089	0.721219142	-0.88002968	1.484987974	1
        0.504664247	0.637967905	-0.029778369	0.214573532	1
        0.353414385	0.122662281	-0.36908448	0.633992314	1
        0.06206467	1.291578268	-0.12800483	-0.187804252	1
        0.978400336	1.362776791	0.008997507	-0.559209287	1
        1.987664896	1.461088216	1.2366329	0.720534623	1
        1.682162211	1.744531547	0.79876113	-1.99810791	1
        0.405820039	0.660841384	0.59427464	-0.853963196	1
        -1.127549878	1.742489376	-1.1173654	0.877738297	1
        -2.621671244	-1.003003798	-0.30031502	1.133033514	1
        0.03136493	-0.146694891	-0.22303931	-1.443643332	1
        -2.081122269	-0.832433186	0.88084489	1.408046961	1
        -1.374474946	1.453967013	-0.98930311	1.361473441	1
        0.039564431	-0.875958287	0.20782922	0.589630961	1
        0.161790909	-1.069001996	1.1486169	-0.756264627	1
        1.685179778	-0.75523051	2.8383803	-0.645455718	1
        -0.650472468	-1.877122128	-0.48096138	0.404590696	1
        -0.369680909	-0.295510316	-0.93873715	-0.649072707	1
        -0.388465342	-0.794262015	0.13821772	-0.755646229	1
        1.573537198	1.023378228	-0.2690185	-0.261744559	1
        1.535600986	1.007604097	0.58648568	-0.733405232	1
        2.838368721	1.217308884	1.2898822	0.928042114	1
        -0.67574372	0.612951179	-1.718312	-0.265743762	1
        1.566799184	0.897748326	0.43899557	0.953139484	1
        2.159554345	3.774286632	-1.3084564	0.225046501	1
        1.72444033	0.054555732	1.2808177	0.085499868	1
        -0.417431884	-0.041163129	-1.4104198	-0.094548583	1
        0.479661704	0.756600114	-1.6421682	-0.614232421	1
        1.749947342	0.709843571	1.1643064	0.257667363	1
        -0.259729472	-0.878020567	-0.1236102	-0.950645208	1
        2.879556115	2.042335349	2.3072112	-1.428057909	1
        -0.507937019	1.033820507	-1.4780095	0.903299332	1
        -0.36762458	0.520849135	-0.96716303	0.620639503	1
        1.631517372	0.031098914	1.9803051	1.874994516	1
        -0.568253797	0.168496375	-0.56464994	-1.08282125	1
        0.06952395	0.856690284	-0.90721697	-0.20099327	1
        -0.479112729	-1.101703707	0.23088951	-0.45474714	1
        -0.587161784	0.998443627	-1.228979	1.426177025	1
        0.029946311	0.115764403	-0.084604912	-0.129210934	1
        0.019423787	-0.295154191	-0.24714556	-1.622820377	1
        1.30475115	1.018169724	1.3027387	0.739985764	1
        0.29182982	-0.365768111	0.92012531	1.152996302	1
        -0.246398803	2.196057522	-1.9387364	1.248598814	1
        -0.060494607	-0.628744968	-0.67120713	-1.295482397	1
        0.57795722	1.08202236	1.2026428	0.831017196	1
        -0.250612244	1.366069427	-1.70397	-1.896693826	1
        0.257965413	1.147646776	-0.67351264	-0.085306488	1
        0.021825005	1.447116128	-0.2968592	0.403400153	1
        0.789923422	-0.081785568	1.2179976	-0.068368085	1
        -0.200345782	-1.213329302	0.62253243	0.435301393	1
        1.510085625	1.54404272	-0.000913913	-2.395765781	1
        -0.121777855	-0.062277364	0.30189893	0.581741214	1
        -0.369651806	-1.095105277	-0.68956989	-0.237612948	1
        0.73119375	0.302130831	-0.28832045	-1.885818601	1
        0.145915033	-1.806965576	1.234746	-0.549516857	1
        0.604574396	-0.882275458	1.0400311	0.846832395	1
        -0.08156101	-0.250372346	0.044467911	0.156423509	1
        1.648636205	1.705995326	0.60326141	1.821676612	1
        0.551714162	0.61639781	0.28857526	0.257510275	1
        1.008851498	0.085052137	0.72671276	0.682576597	1
        1.369560826	-0.151226337	1.4430194	0.894094169	1
        2.019575138	0.817953749	1.4202383	-0.908778727	1
        0.071313501	1.910097761	-1.3284948	-0.416086346	1
        0.195402003	-0.663286762	1.5791408	0.599975407	1
        -0.343328104	0.746350868	-0.61177123	-0.806738853	1
        -2.072657509	0.574861137	-2.683156	0.919928014	1
        0.804104343	1.176045878	0.59713495	0.567755103	1
        1.738190733	0.220938675	1.1950858	1.018856406	1
        1.680707583	2.205224387	0.64724529	-0.374434948	1
        1.216733677	1.010786227	-0.28778338	-1.101846695	1
        3.385888259	2.832877986	0.83347684	-0.223545462	1
        0.444128321	-0.48511792	0.18479829	0.098429322	1
        -0.320366725	-1.245763429	-1.0147358	-0.834677994	1
        -0.243638963	-0.703039245	-0.2492809	-0.506184816	1
        0.860359135	-0.812865988	0.99402326	-1.453499198	1
        -0.002763535	0.377732284	-0.29582185	-0.941500306	1
        -0.662974107	-0.834565059	-0.70891792	0.180389285	1
        -1.198294097	-0.061280028	-1.9991943	0.539019763	1
        -0.585788123	0.268284573	-0.6703648	-0.986955166	1
        1.770094044	1.170129128	0.72613424	-0.691646576	1
        -0.674077676	-0.749020599	0.99138242	1.825193167	1
        0.776922985	1.154459901	-0.008567754	-0.182889298	1
        -0.059947667	1.200949676	-0.31821302	-0.339381337	1
        1.174172691	-0.001668893	1.4264268	-0.682170033	1
        2.033411288	2.550829865	0.050112683	-0.819151282	1
        -0.055958349	0.115594843	-0.61372089	0.025014423	1
        -0.52496411	-0.493281862	0.37492898	0.154808223	1
        -1.776172154	-0.359429619	-2.7953036	-0.153206602	1
        0.360046726	0.743303591	0.003142778	1.067886353	1
        -0.459587059	-1.171964189	0.40928638	-0.53653574	1
        -1.135493583	-0.820993325	-0.76867664	1.191984296	1
        0.401983297	1.192430931	1.1190884	0.022380913	1
        -2.027286735	0.146184879	-1.5072685	-0.336037278	1
        -0.487886262	-0.481852693	1.3366268	0.748001099	1
        -1.357878584	0.894542891	0.10188967	1.766305208	1
        -3.346331762	-0.742005092	-1.7030222	0.866903186	1
        -1.066229096	-0.275289965	-0.09978497	-0.276601553	1
        1.396152123	-0.498816611	1.3488725	-1.329085946	1
        2.273598143	1.038228331	2.4344578	0.653880298	1
        -0.501223122	-0.087056937	-0.013123662	0.207620665	1
        -0.0469687	-0.068879368	0.28082237	1.217902899	1
        1.460829374	0.866443975	0.80883706	-1.027331829	1
        2.801356613	1.988352058	2.1905129	0.317375869	1
        -1.055550858	-1.324202238	-0.40844488	-0.114212967	1
        1.984940154	0.4538425	2.5602038	-1.263386846	1
        -0.64324544	-0.87849885	-0.96521264	-1.16855073	1
        -1.369910028	0.674502255	-1.8828992	1.142101645	1
        -0.267768911	1.287494661	-1.3718306	-0.406304985	1
        0.302062394	1.34849924	-0.76795125	-2.039321661	1
        -2.106053719	-0.03958411	-1.0398813	1.602352738	1
        1.17891689	0.988690455	0.91100222	-0.011822892	1
        1.171590217	-0.259302209	1.6387626	-0.517964065	1
        -0.664596628	0.540292938	0.16086419	1.194535971	1
        0.336377511	0.749615331	0.35418275	0.130313724	1
        -1.042664983	0.056105201	-0.62258971	0.451351762	1
        1.73751881	0.562253375	0.89182043	1.43334651	1
        0.660748666	0.784975395	-0.32670894	-0.58539021	1
        0.5907365	0.737331241	-0.36102119	-0.687453926	1
        2.000272284	0.438532099	1.8195043	-0.22884272	1
        1.170217601	1.519695044	-0.68533117	-1.519780755	1
        1.945670415	1.109046459	0.92287052	-0.689920545	1
        -0.345629523	-0.625142395	-0.071962073	1.00156939	1
        0.550000807	0.086546541	0.6157701	0.304089665	1
        0.246654197	0.390018605	0.68351966	1.231733322	1
        0.731810602	0.109808445	0.18894453	-1.085228205	1
        -0.326650973	-0.489336788	-0.49680302	-0.80426836	1
        0.990211513	0.031182558	0.84198838	1.043021441	1
        1.494480459	1.424500576	-0.55434942	-2.199479342	1
        0.912495524	0.780917577	0.021309825	-0.30249998	1
        2.192799844	1.56473612	0.51400584	-0.096103974	1
        1.401118052	0.971550561	-0.43138653	1.366858482	1
        1.558100307	1.287604711	-0.48156577	0.291716993	1
        1.16618586	0.374742261	0.25792801	0.149989203	1
        0.118044193	0.829850779	-0.10961017	-1.059123755	1
        -0.47684788	1.303393022	-0.53728211	0.17749092	1
        1.116457005	1.191093401	0.78786165	0.758893013	1
        -0.960062666	-0.202599748	-1.4642472	-1.054252386	1
        -0.297352427	0.247771979	-0.28441346	1.101977229	1
        -1.224575627	0.268156962	-0.84619445	1.417873144	1
        -0.638214415	1.786382691	-0.50422162	0.635216534	1
        -1.56573991	1.334625915	-1.5978881	0.306149662	1
        -0.973032226	-0.275109097	-0.14766158	0.368812829	1
        -0.006803407	2.587197319	-0.1560659	0.39623484	1
        0.77482992	0.993528203	0.93282872	-0.64488101	1
        -1.092680733	-0.086499437	-1.8840668	-1.366536617	1
        0.398040003	0.771667846	-0.3645632	-1.268811345	1
        -1.023103601	-0.186637871	-2.1058774	-1.165326357	1
        1.643543138	1.417310722	1.0969425	-0.810718	1
        1.902323525	0.133129545	1.7896419	0.532342374	1
        1.615375979	2.679040439	-1.0932097	-0.69253093	1
        -0.845145836	-1.928728573	-0.27053127	0.616316915	1
        -0.450446596	-0.463154601	-0.2038215	0.588288188	1
        -1.180799553	-1.811313914	-0.89952683	-0.054031987	1
        0.054135206	-0.160570042	0.17143424	0.279036045	1
        -1.18486546	-1.651408361	-0.23010905	0.937014163	1
        0.099497448	0.616523935	-0.52966899	-0.091634467	1
        -0.206840179	0.9538597	-1.4839393	-0.760237694	1
        1.369516159	0.053142027	1.5885186	-1.466513634	1
        -0.89477751	-1.785321279	0.006506977	0.430659145	1
        0.13349539	1.062464909	-0.38280708	-0.412216663	1
        1.124973898	0.257662163	1.2272228	-2.456591129	1
        -0.725123081	-2.0119379	-0.46998692	-0.586715579	1
        0.404515253	-0.64361964	0.53943664	-0.715762675	1
        -0.171277617	0.318611183	0.19423585	0.432849526	1
        1.092968743	0.125425422	1.5116587	1.298630476	1
        0.094069991	0.29855057	0.86813289	1.436923862	1
        0.169847321	0.668558994	-0.52042389	-0.544410408	1
        -0.543167937	-0.400386086	-0.39999506	-0.735673845	1
        -1.715012348	-0.091552443	-1.965409	1.203787327	1
        1.906496022	2.299897985	0.078706086	-0.140225142	1
        1.581328598	1.265657531	0.45007551	0.861727774	1
        0.624444971	0.162755506	0.40156975	-0.838340819	1
        -0.822754269	1.227363275	-1.7734042	1.782532215	1
        2.25640432	1.492126481	1.1830047	-0.724277377	1
        2.835122956	1.376418845	1.6710658	-2.427468538	1
        -1.496005834	-0.344610857	-1.2129704	-0.517718017	1
        0.284867357	2.34552033	-0.22397284	0.91401732	1
        0.605324747	0.725666864	0.68613029	-1.240846395	1
        0.34720859	-0.081721502	0.3497493	0.195873201	1
        0.676933258	0.27897839	0.000332565	-0.027382007	1
        1.186178321	0.827958507	0.34542769	-0.616443932	1
        -0.470521202	0.981087586	-0.91224575	-1.074734211	1
        -0.20994189	0.233644223	-0.24474028	0.001878535	1
        0.434123313	-0.30787606	0.75990587	-0.6174528	1
        1.787511084	2.388079843	1.2591715	-0.831545711	1
        1.436884279	0.280351734	1.1412332	1.118562698	1
        -0.914920228	-0.575707415	-0.81304592	-0.654012799	1
        1.650166278	1.093000644	0.62265044	-0.494431436	1
        2.533222281	2.428315276	1.1664673	0.1955477	1
        2.185095008	0.358594024	1.6542296	0.08546333	1
        1.030696596	3.403739089	-1.9185491	0.708471358	1
        1.542974844	0.298411602	0.42238083	0.560210645	1
        0.801854914	0.130924815	0.35574433	1.098294616	1
        1.045609667	0.399975214	-0.46340662	-0.772758305	1
        -0.35505527	0.298340443	-0.39471194	-0.325804234	1
        1.384400051	1.452850584	0.50813758	0.066550784	1
        0.898868061	1.176748518	1.0961409	1.638298988	1
        0.222390729	0.35826585	-0.88916874	-2.094282627	1
        3.544442273	2.731516246	1.5296627	1.146277308	1
        1.319710067	-0.445429338	0.42977795	-1.863728523	1
        -0.011594773	-0.791000975	-0.050944496	1.155000925	1
        0.845069535	-0.428432954	0.017012006	-0.541050732	1
        1.07505549	1.012970733	0.84759355	0.45574066	1
        2.030935552	1.568983781	0.11349199	-1.063768506	1
        0.530433837	0.607483643	-0.18591885	1.29447794	1
        0.105998317	0.10743053	-0.61634797	-0.305358082	1
        1.942705964	2.794142321	0.65725827	1.817641854	1
        -1.515867267	-0.599449977	-1.2352723	-0.886833429	1
        -1.006013977	-1.391069456	-0.58581084	1.186745524	1
        1.284427506	1.026766435	0.52480716	-1.399682283	1
        -0.428645961	-0.575259431	0.19599925	-0.663582563	1
        -0.132124641	-1.461985216	0.066178747	0.003051514	1
        0.839404274	-0.969236956	0.97428679	-0.397866726	1
        2.073201554	1.055008783	2.2273459	-0.52167213	1
        -1.729191003	-1.149621472	-0.6212334	0.229773745	1
        0.734151991	1.417457059	-0.28412658	-0.763225555	1
        0.822760447	0.53257469	0.49946886	0.118458584	1
        1.66187679	1.164238314	0.78830165	0.550287366	1
        1.478365178	0.265875916	0.3598929	-1.817171574	1
        1.819204444	0.533288817	1.4630803	0.928802013	1
        0.292221445	1.08328561	-1.0050139	-1.32542932	1
        1.814084438	2.797097008	-0.18509383	-0.940727532	1
        -0.921201969	-1.420494993	-0.75686544	1.661290765	1
        -0.181054214	0.388643861	0.072589181	-1.064328194	1
        -2.220213273	-2.419516325	-0.91026896	-0.71898073	1
        0.394880071	-0.304004877	0.95336044	0.258582532	1
        1.225152557	2.249175311	-0.024598621	0.58288914	1
        0.023914324	0.483870358	-0.2395944	-0.763972938	1
        1.185646384	0.74914074	0.31086591	-2.854864359	1
        1.06887747	0.53200209	0.097594813	0.510442555	1
        -1.834757128	0.023798793	-2.9628427	0.673982084	1
        0.931372793	0.176084219	0.48551068	1.742449641	1
        -0.450812503	0.189572929	-1.7032037	0.262873113	1
        0.539495626	0.104635268	-0.18355455	1.120529532	1
        0.97375906	-0.227429301	0.36517012	-0.268397808	1
        0.293303718	0.18009499	0.18657832	-0.763709903	1
        0.318104455	0.842000204	0.13787298	-0.880482733	1
        -0.200115679	-0.499925417	0.64471412	0.850100398	1
        -0.174193187	0.552457589	-0.024909573	1.555550814	1
        0.666755994	0.41635673	0.92305517	-1.422539473	1
        -0.430926011	-1.356447441	0.6196515	2.052659512	1
        -1.606550115	0.825304331	-1.9254605	0.059124753	1
        -0.496422677	0.946726771	-0.87458831	-0.246258095	1
        -1.536702318	-0.853024869	-1.2395459	-0.284733385	1
        -0.335474395	1.251755507	-0.1972854	1.608720183	1
        1.082581071	2.881840558	-0.089047253	-0.379893571	1
        0.362091411	1.437852593	-0.98801267	-1.204823256	1
        0.068028794	0.222575466	0.03504429	-0.749414206	1
        0.092892411	1.070912267	-1.1666054	-0.83405906	1
        0.667661484	-0.673281764	1.4891337	-0.500867367	1
        1.155825942	1.68599459	0.82060891	0.398199141	1
        1.113090862	1.222578848	1.332576	1.141205907	1
        -0.976913486	-1.834179198	1.016374	0.187983334	1
        1.643269323	2.633333795	1.1519361	0.605461299	1
        -1.30542839	-1.078757174	0.22541577	0.719581187	1
        0.644927393	0.895563	0.1802312	-0.846501052	1
        1.293905665	0.537375831	1.2999177	-0.01685182	1
        -0.700377945	-0.861254818	-0.56558478	-1.541094899	1
        2.205799935	2.843787067	1.3225936	-0.611977816	1
        1.300169021	0.137176127	1.2807543	-0.007746615	1
        0.97098861	0.108044775	0.18416473	0.0953779	1
        0.08815565	1.650797875	0.59358221	1.906296492	1
        0.687972239	1.846886368	-0.85616833	-0.329969049	1
        1.152693037	1.131487281	-0.073638864	-0.659285128	1
        1.462060063	0.084063024	0.96776336	0.074267276	1
        -0.091866597	1.221710293	-0.50011206	0.110657983	1
        -1.478604645	-1.971187504	0.051560365	-0.362953931	1
        -1.062213636	0.571312992	-1.2675583	-0.524878979	1
        -0.206137341	1.376892774	-0.39812943	-1.027723551	1
        -0.971490908	-0.976754935	1.0425651	1.160378695	1
        -0.310186839	0.967880337	-0.42192143	-0.590560853	1
        0.14107624	0.367742831	-0.33549696	0.7599563	1
        0.503741442	0.766459463	-0.055386547	-0.894898236	1
        -1.122788966	-1.67869732	-0.75207573	-0.796754539	1
        0.058614125	-1.657836648	1.2919241	2.040048122	1
        0.338836092	0.215321613	-0.37860978	0.534849644	1
        -0.660242696	-0.358193966	-0.53130174	-1.916779995	1
        0.389387443	0.838922201	-1.566937	0.726560235	1
        -0.096843049	-1.229802111	0.82632172	0.167143926	1
        0.55609022	0.621119743	-0.53814673	-0.694572389	1
        -0.076593029	1.564867875	-1.5946685	0.451595694	1
        -0.602121595	-0.683783868	-1.4812297	-1.883445621	1
        -0.458457643	1.371194681	-2.2667511	0.143382892	1
        0.875726399	-0.9076753	0.85075724	-1.304462194	1
        0.770045608	0.685879278	-1.5364226	-0.871166527	1
        1.196838722	0.920989867	0.22853293	-1.442025185	1
        -0.679124893	0.366047944	-2.2240505	0.050734904	1
        0.506814791	-0.11488596	0.18972059	1.562186718	1
        0.602476009	-0.975031887	0.69079167	0.921800017	1
        -0.527852935	-0.069613515	0.18024226	1.552278876	1
        0.33257844	0.181722538	-0.37459606	1.068847537	1
        0.840939949	-0.357387958	1.9381874	0.254359663	1
        0.228421201	0.461004676	0.27309331	1.011440158	1
        1.133831781	0.147552075	1.263317	0.159159288	1
        -0.306166426	-1.011279969	-0.56177825	-1.262700796	1
        -1.363311893	-0.177716576	-0.11900122	1.6413697	1
        0.777828271	0.494100488	0.55098659	-1.055361509	1
        -1.594564851	0.309684812	-2.0143065	-0.971271753	1
        -1.016315574	-1.545486146	0.10177012	-0.055107225	1
        -0.467581723	0.302015974	-0.15523769	0.541838646	1
        0.523914368	0.592917628	0.052957147	-1.818330646	1
        0.466726405	-0.072091085	-0.8108384	0.502443373	1
        1.41646654	0.080344218	1.5999256	-0.15753521	1
        -0.271549416	-0.22162537	-1.4794725	0.668462217	1
        1.191494868	2.177916008	-1.9791698	-0.692543685	1
        2.068074221	1.425055998	0.71274877	-0.237058118	1
        1.677457706	1.550140339	0.60606205	-0.861968637	1
        0.155208322	-0.093212597	1.1267331	0.417369246	1
        0.446712601	0.533618577	0.31485763	-0.991056323	1
        -0.152073232	0.451466479	-1.4733193	-2.100560665	1
        1.101595204	0.371385165	0.83345437	0.794319451	1
        -0.280035499	0.163838462	-0.61874098	-0.749853432	1
        0.103961938	0.796436199	-0.64143169	-1.069675565	1
        0.565529916	0.772654143	-1.1426119	2.040788651	1
        1.411798663	1.292781812	-0.63896978	-0.047552545	1
        -0.407042378	-0.254689234	-1.1916678	1.480395198	1
        1.319963993	1.524366659	-0.57570261	0.670222938	1
        -0.045724559	0.161998493	-1.8820099	1.160805345	1
        2.385424926	1.000083149	0.98692501	0.385883391	1
        -1.428925754	-0.659159981	-0.51988679	1.169258595	1
        0.306423471	1.044527449	-0.30389833	0.740783572	1
        0.48976163	-0.030432127	0.19265087	0.412113667	1
        -0.711332886	-0.803207181	0.54173273	1.11837709	1
        0.503895068	2.51793132	-0.53048748	0.95046103	1
        1.051830986	1.769546129	0.14760788	-0.373573661	1
        1.588138608	0.876397824	1.4649967	0.541335464	1
        0.267907675	0.490749007	0.09059076	-0.313331455	1
        1.911123087	0.938300168	0.74149346	-0.966022789	1
        -0.028041911	2.449714219	-2.6593342	0.601737976	1
        -0.533926288	-0.258015955	-0.90313214	-1.303610802	1
        2.133709041	1.263920283	1.6368238	0.082856044	1
        0.831240642	1.399625485	-0.051359508	-0.373487025	1
        -1.253973276	-0.261076863	-1.6146338	-0.622344434	1
        0.291642683	1.082717215	-0.3867023	0.689810336	1
        -0.530144651	1.178583686	-1.0529187	1.423166156	1
        0.532861433	0.437915941	1.4993051	1.972787857	1
        -0.229288404	-0.434795315	0.43962163	0.276872754	1
        -1.576441104	-0.987726961	-1.7787712	-0.893774688	1
        -0.000969738	1.29472294	-2.4618828	-0.490653425	1
        -0.049129182	0.442089643	-1.5112144	-0.720774531	1
        1.049673632	0.72932415	0.17658219	0.245849356	1
        1.231778755	0.294622983	1.4753871	-0.215961784	1
        -0.487506702	0.91686007	-2.1368923	0.279843062	1
        2.134575644	0.821464582	2.2200568	0.077150851	1
        1.5783656	-0.2826138	0.70910889	-1.036934018	1
        2.256023091	1.473825111	0.31034198	-0.315343052	1
        1.992062036	0.226729765	1.0994841	-1.046056271	1
        2.037585267	1.103956728	-0.003700096	-1.100166678	1
        0.519153796	1.747035756	-1.0308123	0.714734554	1
        1.288666196	1.479906241	0.90627044	2.109130144	1
        0.794361732	0.945201302	0.22384648	0.651921749	1
        -0.414914333	2.390341143	-2.2748609	-0.044636175	1
        1.388244509	-0.525254746	1.2523166	-1.237596512	1
        0.334441389	1.111382435	-1.2677923	-0.261127979	1
        1.995851358	2.515216092	0.084404506	1.012967348	1
        1.15100116	0.185914987	1.0592039	0.440008402	1
        -1.195638506	-2.017640374	0.11869253	0.296571404	1
        -1.345733802	1.130852201	-3.0917771	-0.816199899	1
        0.569338862	1.222476818	0.48568562	0.440685391	1
        1.659731223	1.283338525	1.65017	1.584262013	1
        0.911203365	-0.149173043	1.1946204	-0.472100317	1
        0.005755929	-0.844045611	0.53117287	0.724917948	1
        -0.422069737	-0.10818273	-0.58535796	0.837846279	1
        0.102120004	0.589557378	-1.1117216	0.126529559	1
        -0.796807082	-1.188033731	0.031127768	-0.355615675	1
        -0.343045308	-0.936561735	0.62699968	-2.090103388	1
        1.047403715	-0.253324928	1.1111848	-0.473612905	1
        3.666623223	1.659926219	2.5793393	1.168813586	1
        2.232043172	-0.144896166	1.080273	-0.173625857	1
        0.600114523	0.744961424	-0.75437593	1.502847552	1
        0.715409833	2.414621337	-1.5848877	0.588480532	1
        1.702817835	1.784973903	-0.70046383	-0.291972518	1
        1.109365131	-0.052130954	0.95906639	-0.41975826	1
        -0.375133953	-0.584236829	-1.1430243	-0.911647379	1
        1.438303553	1.665183337	0.45094854	-0.761468053	1
        1.675727592	1.940262945	0.65329158	-1.582750797	1
        1.550440011	1.167100222	0.45285743	0.216547847	1
        2.957766464	1.505111904	1.2613249	-0.174294665	1
        2.050865816	2.570623429	0.3637538	-0.148518711	1
        -1.57100199	-0.491075739	-1.5198596	0.511733532	1
        -1.23833859	-0.509186849	-1.4818666	1.298412323	1
        -0.202088791	-0.270081863	-0.28698397	-0.84775877	1
        -0.472653441	0.381014511	-0.18244989	0.364977032	1
        1.079276045	2.393558636	0.89653265	0.463201255	1
        -1.095290573	-1.43262671	0.67142969	1.421127558	1
        0.064871059	0.050021491	-0.59022349	0.285861194	1
        1.279792918	0.907440252	0.54480374	1.231999874	1
        1.271580063	1.905640683	-1.5632179	-1.909351707	1
        0.630568241	0.894489444	-0.78828269	-0.429838836	1
        0.995218398	1.064264706	-0.69712102	-1.297155619	1
        1.40174327	-0.772011557	1.862617	-1.018269181	1
        0.811853251	1.174389243	-0.073078081	-0.581862152	1
        -0.38913434	0.376496501	-0.42850593	1.522095203	1
        -0.072247694	-0.882307231	0.47700226	1.962681651	1
        -0.018861117	-0.295350909	0.4496572	-0.759648263	1
        -1.36083909	-0.495552063	-1.2990526	-0.118149273	1
        -1.285530668	-0.967699349	-1.3081455	-0.41324079	1
        1.060670263	2.140846119	-0.97184974	-0.072428375	1
        -0.827690473	0.343958771	-1.7634983	-0.319794297	1
        -0.766637947	0.474436023	-2.262917	-0.46278289	1
        0.694712809	0.519376815	0.80583298	2.359358072	1
        -0.157289882	-0.399764791	-0.38939992	-0.894503832	1
        0.92314577	0.929370568	0.62367988	-0.581813157	1
        0.157677939	1.352057443	-0.38100165	0.817532539	1
        0.251283716	0.719297276	0.68220204	-0.001898847	1
        0.369110989	0.420091823	0.87224859	0.295643121	1
        -0.641725379	0.309888974	-0.60706103	1.259869337	1
        1.393069009	0.888246865	0.80212265	-0.44701153	1
        -0.200195325	0.544443742	0.76123255	1.529913545	1
        0.479777357	-0.629374748	1.0931542	-0.266801387	1
        -1.720328436	-0.043816155	-1.9542994	-1.472294927	1
        -1.401988281	1.092820341	-1.9442493	0.741935849	1
        -0.154794284	0.747836584	0.60610777	0.999301076	1
        -0.757148582	-0.152645951	-0.36053509	0.759770811	1
        -0.079019626	0.156815456	-0.48589972	-0.778258204	1
        0.87963834	0.904075565	0.018582027	-3.116837263	1
        2.497064342	2.322330029	0.37049922	-0.287094861	1
        1.601624588	1.383604617	-0.14710614	0.049715698	1
        2.499766732	3.440380128	0.15897609	0.609787345	1
        1.460554428	1.167312415	-0.33544806	0.711322606	1
        0.504558202	1.507200272	-1.4597708	0.95258224	1
        0.511972103	0.865345072	-0.014675764	0.585636377	1
        0.580245376	0.742522076	0.29562187	-0.588085592	1
        -0.547052552	0.456810515	0.97195315	2.632874966	1
        0.216704418	0.192523252	0.33183163	0.742264867	1
        -0.722032622	0.84194741	-1.2032672	-1.005480528	1
        0.164961468	-1.41402762	0.43001717	-0.296364516	1
        
    
        ]

	y = reshape(data[:,1], length(data[:,1]), 1)  # matrix     
	x = data[:,2:3]
    z = data[:,5:5]
    u = data[:,5:5]
    q = data[:,4:4]
	v = data[:,5:5]
	PorC = 1
	nobs = 600
	dum2 = ()
	ivar = [1
    1
    1
    1
    1
    1
    2
    2
    2
    2
    2
    2
    3
    3
    3
    3
    3
    3
    4
    4
    4
    4
    4
    4
    5
    5
    5
    5
    5
    5
    6
    6
    6
    6
    6
    6
    7
    7
    7
    7
    7
    7
    8
    8
    8
    8
    8
    8
    9
    9
    9
    9
    9
    9
    10
    10
    10
    10
    10
    10
    11
    11
    11
    11
    11
    11
    12
    12
    12
    12
    12
    12
    13
    13
    13
    13
    13
    13
    14
    14
    14
    14
    14
    14
    15
    15
    15
    15
    15
    15
    16
    16
    16
    16
    16
    16
    17
    17
    17
    17
    17
    17
    18
    18
    18
    18
    18
    18
    19
    19
    19
    19
    19
    19
    20
    20
    20
    20
    20
    20
    21
    21
    21
    21
    21
    21
    22
    22
    22
    22
    22
    22
    23
    23
    23
    23
    23
    23
    24
    24
    24
    24
    24
    24
    25
    25
    25
    25
    25
    25
    26
    26
    26
    26
    26
    26
    27
    27
    27
    27
    27
    27
    28
    28
    28
    28
    28
    28
    29
    29
    29
    29
    29
    29
    30
    30
    30
    30
    30
    30
    31
    31
    31
    31
    31
    31
    32
    32
    32
    32
    32
    32
    33
    33
    33
    33
    33
    33
    34
    34
    34
    34
    34
    34
    35
    35
    35
    35
    35
    35
    36
    36
    36
    36
    36
    36
    37
    37
    37
    37
    37
    37
    38
    38
    38
    38
    38
    38
    39
    39
    39
    39
    39
    39
    40
    40
    40
    40
    40
    40
    41
    41
    41
    41
    41
    41
    42
    42
    42
    42
    42
    42
    43
    43
    43
    43
    43
    43
    44
    44
    44
    44
    44
    44
    45
    45
    45
    45
    45
    45
    46
    46
    46
    46
    46
    46
    47
    47
    47
    47
    47
    47
    48
    48
    48
    48
    48
    48
    49
    49
    49
    49
    49
    49
    50
    50
    50
    50
    50
    50
    51
    51
    51
    51
    51
    51
    52
    52
    52
    52
    52
    52
    53
    53
    53
    53
    53
    53
    54
    54
    54
    54
    54
    54
    55
    55
    55
    55
    55
    55
    56
    56
    56
    56
    56
    56
    57
    57
    57
    57
    57
    57
    58
    58
    58
    58
    58
    58
    59
    59
    59
    59
    59
    59
    60
    60
    60
    60
    60
    60
    61
    61
    61
    61
    61
    61
    62
    62
    62
    62
    62
    62
    63
    63
    63
    63
    63
    63
    64
    64
    64
    64
    64
    64
    65
    65
    65
    65
    65
    65
    66
    66
    66
    66
    66
    66
    67
    67
    67
    67
    67
    67
    68
    68
    68
    68
    68
    68
    69
    69
    69
    69
    69
    69
    70
    70
    70
    70
    70
    70
    71
    71
    71
    71
    71
    71
    72
    72
    72
    72
    72
    72
    73
    73
    73
    73
    73
    73
    74
    74
    74
    74
    74
    74
    75
    75
    75
    75
    75
    75
    76
    76
    76
    76
    76
    76
    77
    77
    77
    77
    77
    77
    78
    78
    78
    78
    78
    78
    79
    79
    79
    79
    79
    79
    80
    80
    80
    80
    80
    80
    81
    81
    81
    81
    81
    81
    82
    82
    82
    82
    82
    82
    83
    83
    83
    83
    83
    83
    84
    84
    84
    84
    84
    84
    85
    85
    85
    85
    85
    85
    86
    86
    86
    86
    86
    86
    87
    87
    87
    87
    87
    87
    88
    88
    88
    88
    88
    88
    89
    89
    89
    89
    89
    89
    90
    90
    90
    90
    90
    90
    91
    91
    91
    91
    91
    91
    92
    92
    92
    92
    92
    92
    93
    93
    93
    93
    93
    93
    94
    94
    94
    94
    94
    94
    95
    95
    95
    95
    95
    95
    96
    96
    96
    96
    96
    96
    97
    97
    97
    97
    97
    97
    98
    98
    98
    98
    98
    98
    99
    99
    99
    99
    99
    99
    100
    100
    100
    100
    100
    100
    
    ]
	tvar = [1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    1
    2
    3
    4
    5
    6
    
    ]

	idt = get_rowIDT(vec(tvar))
    W1 = [[0,1,1] [1,0,0] [1,0,0]]
    W = ones(100, 100) -I(100)
    W[1:3,1:3]=W1
	# -- SMA, TRUN ----

	posvec = (begx=1, endx=2, begz=3, endz=3, begq=4, endq=4, begu=5, endu=5, begv=6, endv=6, begρ = 7, endρ = 7, begτ = 8, endτ = 8)
	rho = ones(8,1); rho2=vec(rho)
	# @test LL_T(SMAT, data[:,1],x,z,q,u,v,0.1,0.1,W,1,600,posvec,rho, idt, nothing)  ≈ 5.97091 atol=1e-5

	jlms, bc = jlmsbc(SMAT, PorC, posvec, rho2, data[:,1], x, z, q, u, v, W,idt)
    # @test jlms[1,1] ≈ 3.13039 atol = 1e-5
    # @test bc[1,1] ≈ 0.13926 atol = 1e-5	

	nofvar = (nofobs=600, nofx=2, nofz=1, nofq=1,	nofu=1, nofv=1, nofρ = 1, nofτ = 1,nofpara=8, nofmarg = 3)
	ssfmodel_spec(ssfpanel(SMA), ssftype(prod), ssfdist(trun), timevar(tvar), idvar(ivar), 
	             depvar(y), frontier(x),μ(z), hscale(q),  σᵤ²(v), σᵥ²(v),ρ(0.1),
                 τ(0.1),
                 weight(W))

    ssfmodel_init(  #frontier([0.1,0.1]),             # may skip and use default
    μ([0.1]), 
    hscale([0.1]),              
    σᵤ²([-0.1,]),    # may use a vector
    σᵥ²([-0.1]) ,
    ρ(-0.1),
    τ(0.1) )    

    ssfmodel_opt(warmstart_solver(NelderMead()),   
    warmstart_maxIT(200),
    main_solver(Newton()), 
    main_maxIT(2000), 
    tolerance(1e-8),
    verbose(true),
    banner(true),
    ineff_index(true),
    marginal(true),
    rii(true),
    table_format(html),
    message = false)

    res =  ssfmodel_fit()
    @test  res.converged == true


    aa, bb = get_marg(SMAT, posvec, nofvar, rho2, v, q, u,W,idt)

    @test aa[1,1] ≈ 755.4993962231897 atol=1e-5
	@test bb[1] ≈ 703.32487 atol = 1e-5

	
	
end

